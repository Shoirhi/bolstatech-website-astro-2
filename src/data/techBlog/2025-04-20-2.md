---
isDraft: true
title: Astro製のWebサイトでGoogleアナリティクスを導入する
description: Astroフレームワークで製作されたWebサイトへ、Googleアナリティクスを導入する手順と設定方法を解説します。Astro製のシンプルで高速なWebサイトに分析ツールを統合し、Webサイトの運用に役立てることができます。
categories: [astro]
author: hiroshi-kamikawa
pubDate: 2025-04-20
---

Astroフレームワークで製作されたWebサイトへ、Googleアナリティクスを導入する手順と設定方法を解説します。

分析ツールであるGoogleアナリティクスをWebサイトへ導入することで、Webサイトの日々の改善が可能になり、運用に役立てることができます。

## 手順

1. [Googleアナリティクス](https://analytics.google.com/analytics/web/provision/#/provision) にてアカウントを作成し、画面の指示に従ってGoogleタグを発行する。

2. Astroプロジェクトにて、Partytownをインストールする（[参考：Partytownの公式ドキュメント](https://partytown.qwik.dev/google-tag-manager/)）。
```
npx astro add partytown
```

3. astro.config.mjsに、以下のコードを追記する。

```
export default defineConfig({
  integrations: [
    partytown({
      config: {
        forward: ["dataLayer.push"],
      },
    }),
  ],
});
```

4. Googleアナリティクスの初期設定で取得したGoogleタグを、headタグの直後に挿入する。

```
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-708BQXT8D2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-708BQXT8D2');
</script>
```

5. 挿入したscriptタグに、以下の2つの属性を追加する。
    - is:inline
    - type="text/partytown"

```
<!-- Google tag (gtag.js) -->
  <script is:inline type="text/partytown" async src="https://www.googletagmanager.com/gtag/js?id=G-708BQXT8D2"
  ></script>
  <script is:inline type="text/partytown">
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "G-708BQXT8D2");
  </script>
```

---

>これはブロッククォーと

### これはh3

#### これはh4

##### これはh5

###### これはh6

テーブル
| Markdown要素 | 表記方法 | プレビュー効果 |
|-------------|---------|------------|
| 見出し | `# 見出し1` | <h1>見出し1</h1> |
| | `## 見出し2` | <h2>見出し2</h2> |
| 箇条書き | `- アイテム1` | <li>アイテム1</li> |
| | `* アイテム2` | <li>アイテム2</li> |
| 番号付きリスト | `1. 項目1` | <ol><li>項目1</li></ol> |
| 太字 | `**太字**` | **太字** |
| 斜体 | `*斜体*` | *斜体* |
| リンク | `[リンクテキスト](URL)` | [リンクテキスト](#) |
| 画像 | `![代替テキスト](画像URL)` | 画像表示 |
| コード | `` `コード` `` | `コード` |
| 水平線 | `---` | <hr> |
| 引用 | `> 引用文` | <blockquote>引用文</blockquote> |
| チェックボックス | `- [ ] 未完了` | □ 未完了 |
| | `- [x] 完了` | ☑ 完了 |
